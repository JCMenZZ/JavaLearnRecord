## 项目管理——Maven学习（二）

### 分模块构建Maven工程

分模块构建Maven工程就是对项目进行拆分，然后实现拆分出来的各个模块，最后将拆分出的模块进行串联的过程。通常在企业项目开发过程中，由于项目规模庞大，业务复杂，一般会通过合理的模块拆分将一个大型的项目拆分成多个小的模块分别进行开发，且拆分出的模块可以非常容易的被其他模块复用。常用的拆分方式有两种，**按照业务模块进行拆分**和**按照层进行拆分**。其中**按照业务模块进行拆分**就是将一个项目按照功能进行拆分（如：用户模块、订单模块等），每个模块对应一个maven工程。而**按照层进行拆分**，就是根据业务层、持久层、表现层等进行拆分，每个层对应一个maven工程。通常，一个非常庞大的项目采用按照业务模块进行拆分，一个功能少简单的项目按照层进行拆分。最后将这些拆分好的maven工程进行整合，合并为一个整体项目。通常会由拆分前提供的父工程对子工程进行整合，一般的方式会将一些公共的代码和配置提取到父工程中进行统一的管理和配置。

#### Maven工程的继承

Maven工程之间存在一个继承的关系，通过继承，子工程就可以使用在父工程中引入的依赖。继承的目的是为了消除重复的代码。在pom.xml文件中，我们可以声明一个工程为父工程。通常，被继承的maven工程为父工程，父工程的打包方式必须为pom，如果不明确指出该工程的打包方式，那么这个工程的打包方式就为jar。在子工程的pom.xml文件中，使用parent标签进行父工程的继承。

通过继承，子工程中就不需要去导入依赖坐标了，它会根据父工程中的依赖来进行自动导入，从而减少了重复的代码。

#### Maven工程的聚合

在Maven工程中的pom.xml文件中可以使用modules标签，将其他maven工程聚合在一起，从而实现统一操作。也就是说只要实现了聚合，就可以在当前的maven工程中统一对被聚合的maven工程进行操作。注意：聚合与继承之间没有必然的联系。聚合操作示例如下：

```xml
<modules>
    <module>ssm_Demo</module>
</modules>
```

此时`ssm_Demo`工程就被聚合到了当前的maven工程中了。

利用Maven工程的继承、聚合以及依赖传递等特性，就可以帮助我们分模块的去开发一个项目，从而实现减少重复代码的目的等。

### 问题记录

#### mysql版本问题

最近在练习SSM项目的时候，把mysql从5.0换成了8.0的版本，结果导致了两个问题，具体如下：

1. 在IDEA的数据库插件中无法对数据库进行连接，错误提示为`Server returns invalid timezone. Go to ‘Advanced’ tab and set ‘serverTimezon’`，解决方法为在数据库插件的`Advanced`中将`serverTimezone`设置成`Hongkong`或`UTC`即可，但这种方法不能一次性解决由于时区问题导致的插件无法连接数据库。
2. 由于更换了数据库版本，所以导致了以前的驱动包与数据库版本不对应，从而使得数据库连接失败，获取的Connection对象总报空指针异常。

上述的两个问题的解决方法如下：

1. 用控制台打开mysql，输入命令`set global time_zone='+8:00';`，设置时区即可。此时即可解决由于时区的问题导致的IDEA数据库插件无法正常使用。

2. 对于驱动包的问题，可以使用Maven进行依赖导入，也可以在官网上下载对应的驱动包。这里采用Maven进行依赖管理，在pom.xml文件中，添加如下代码：

   ```xml
   <dependency>
       <groupId>mysql</groupId>
       <artifactId>mysql-connector-java</artifactId>
       <version>8.0.22</version>
   </dependency>
   ```

   添加完成后，使用Maven更新依赖，之后修改`jdbc.properties`文件（主要修改驱动包和URL），具体如下：

   ```properties
   jdbc.driver=com.mysql.cj.jdbc.Driver
   jdbc.url=jdbc:mysql://localhost:3306/ssm_test?useSSL=false
   ```

   此时进行测试即可看到运行成功的结果了。这里修改了驱动所在的包，URL也要根据新的驱动进行更改，如果不改URL，则存在一个`SSL`异常问题，所以需要在URL中指定是否使用`SSL`连接，这里指定为false。

